public void deletePurgeConfig(String id, PurgeConfigurationObj deletionPurgeConfig) {
    Optional<ArchPurgeConfiguration> entity = this.purgeRepo.findById(Long.valueOf(id));

    if (entity.isEmpty()) {
        log.error("Data not available to delete for id {}", id);
        throw new PurgeConfigNotFoundException("Data not available to delete for id=" + id);
    }

    Map<String, Boolean> mismatches = getMismatches(deletionPurgeConfig, entity);

    for (Map.Entry<String, Boolean> entry : mismatches.entrySet()) {
        if (!entry.getValue()) {
            log.error("Deletion failed: Data mismatch in {}", entry.getKey());
            throw new DataMismatchException("Deletion failed: Data mismatch in " + entry.getKey());
        }
    }

    this.purgeRepo.deleteById(Long.valueOf(id));
    log.info("Record deleted successfully for id {}", id);
}
